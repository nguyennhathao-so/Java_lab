<header class="main-header">
  <div class="container">
    <div class="logo">
      <img src="./assets/images/logo/logo.png"
        alt="Red blood drop cradled by a hand holding a smaller drop inside, with World Blood Donor Day text in black and red beside the logo, promoting a caring and supportive message about blood donation" />
    </div>

    <nav class="nav-links">
      <a href="admin/dashboard.html" id="admin-link" style="display: none;">Quản lý</a>
      <a href="home.html">Trang chủ</a>
      <a href="services.html" id="service-link" style="display: none;">Dịch vụ</a>
      <a href="notifications.html" id="notification-link" style="display: none;">Thông báo</a>
      <a href="blog.html">Blog</a>
    </nav>

    <div class="auth-links" id="guest-view">
      <a href="signin_signup.html">Đăng ký</a>
    </div>
    
    <div id="user-view" style="display: none;">
      <span id="user-email"></span>
      <button onclick="handleLogout()" style="margin-left: 10px; padding: 5px 10px; background: #a01515; color: white; border: none; border-radius: 4px; cursor: pointer;">Đăng xuất</button>
    </div>
  </div>
</header>

<script>
// Kiểm tra trạng thái đăng nhập khi trang được tải
function updateHeader() {
  const userEmail = localStorage.getItem('userEmail');
  const userName = localStorage.getItem('userName');
  const authToken = localStorage.getItem('authToken');
  const userRole = localStorage.getItem('role');

  console.log('Current user role:', userRole);
  console.log('Current user email:', userEmail);
  console.log('Current auth token:', authToken);

  // Hiển thị/ẩn link admin dựa vào role
  const adminLink = document.getElementById('admin-link');
  if (userRole === 'ADMIN' || userRole === 'STAFF') {
    console.log('Showing admin link for role:', userRole);
    adminLink.style.display = 'inline-block';
  } else {
    console.log('Hiding admin link for role:', userRole);
    adminLink.style.display = 'none';
  }

  if (userEmail && authToken) {
    // User đã đăng nhập
    document.getElementById('guest-view').style.display = 'none';
    document.getElementById('user-view').style.display = 'block';
    document.getElementById('user-email').textContent = userName || userEmail;
    
    // Hiển thị các link khi đã đăng nhập
    document.getElementById('service-link').style.display = 'inline-block';
    document.getElementById('notification-link').style.display = 'inline-block';
  } else {
    // User chưa đăng nhập
    document.getElementById('guest-view').style.display = 'block';
    document.getElementById('user-view').style.display = 'none';
    
    // Ẩn các link khi chưa đăng nhập
    document.getElementById('service-link').style.display = 'none';
    document.getElementById('notification-link').style.display = 'none';
  }
}

document.addEventListener('DOMContentLoaded', updateHeader);

// Xử lý đăng xuất
function handleLogout() {
  localStorage.removeItem('authToken');
  localStorage.removeItem('userEmail');
  localStorage.removeItem('userName');
  localStorage.removeItem('role');
  window.location.href = 'signin_signup.html';
}
</script>